Class Notes

Summer Institute of Statistics Modeling Infectious Diseases (SISMID) July 15-17, 2015

Module 11: Introduction to Metagenomic Data Analysis 

Instructors: Alexander V. Alekseyenko and Paul J. McMurdie II

Module description: This course is concerned with multivariate statistical analysis of 
microbiome data. We will briefly cover foundational concepts in microbial ecology, 
molecular biology, bioinformatics, and DNA sequencing. The main focus of the course will 
be on developing an understanding of multivariate analysis of microbiome data. Practical 
skills to be developed in this course include managing high-dimensional and structured 
data in metagenomics, visualization and representation of high-dimensional data, 
normalization, filtering, and mixture-model noise modeling of count data, as well as 
clustering and predictive model building. Programming will be done in R and fluency at 
the level of ‘SISMID/SISG Module 4: Introduction to R’ will be expected. 
Pre-requisites: knowledge of Module 1, Probability and Statistical Inference.
Co-listed with the Summer Institute in Statistical Genetics.

Course Website: sismid15m11.bot-tak.org

=========================================================================================

Wed 15 July

Session 1:

Introductions:
	Alex: http://www.med.nyu.edu/biosketch/aleksa01
	Joey: https://scholar.google.com/citations?user=nNQ1LtMAAAAJ

	Diverse group!!

	This course covers three forks: Microbiology, Molecular biology/technology, and 
	Bioinformatics

Lecture 1 - Metagenomics in Biology:
	Exciting and emerging field -- largely due to high throughput data

Lecture 2 - Sequencing technology and upstream processing:
	This course is on downstream processing
		*my MG rhizosphere data is 454 sequencing of 16S gene

Laboratory 1: Sequence pre-processing w/QIIME
	Host: ec2-54-157-46-245.compute-1.amazonaws.com
	Username: student03
	Password: test123
	
	http://qiime.org/tutorials/tutorial.html
	
	Open up terminal:
		ssh student03@ec2-54-157-46-245.compute-1.amazonaws.com
	
		cd qiime_overview_tutorial/
		ls
			Fasting_Example.fna #contains sequences
			> #deliminator symbol
			less #open up file for veiwing
			.qual #is the quality file; -log probabilities of error, higher the number 
				less probability of an error; e^-37
			the quality values for 454 is almost useless
			Fasting_Map.txt #maps the barcode with the descriptions
				sample id, barcode sequence, primer sequence (generic), 
				
			after run look at 
			then log will tell you the number of sequence per sample
			
Session 2:

Laboratory 1: continued; alternative OTU picking
	UPARSE - part of usearch of Qiime *recomended	
	There are denoiser - takes care of homopolymers - specific for 454 data
		*base by base quality is not very useful for 454
		*just use illumina now
	Workflow developed by Joey
		Trim first
		filter after trimming
		Then UPARSE

		*there is an alternative to OTU clustering 
		
		This workshop is not on OTU clustering -- we are going to focus on analysis to do
		after OTU clustering

Lecture 3: Microbiome downstream processing pipeline
	Markdown -- transition from LaTex and Sweave
	
Lab 2: Introduction to phyloseq
		*see R scripts
		
		
=========================================================================================

Thur 16 July

Session 3:

Lecture 4: Descriptive statistics and normalizations
	Simpsons, Shannons, etc. Like from ecology
	Need to normalize based off of unequal sequencing
	
Laboratory 3: Quality control, transformations
	This is an example on different ways to begin your data analysis	
	.Rdata saves your data in a way that R can pull it up quickly
		

Session 4:

Lecture 5: Testing and Multiple Testing

Laboratory 4: Filtering, testing, multiple comparison

	Avoid doing more tests than you need because you will have to correct for
	multiple comparisons

Session 5:

Lecture 6: Mixture models for microbiome data

Laboratory 5: Mixture models for differential abundance testing
	Non parametric way to deal with this is SAMseq {samr} 
		(alternative to negative binomial)
	Neg binomial: if it fits well, it will be very sensitive
		use diagnostic plots to see if that is a good fit
	
